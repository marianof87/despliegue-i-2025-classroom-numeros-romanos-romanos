<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roman Converter</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#94a3b8;
      --accent:#7c3aed;
      --accent-600:#6d28d9;
      --surface:#071026;
      --success:#16a34a;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.03);
    }
    html,body{height:100%;}
    body{
      margin:0;
      background: linear-gradient(180deg, #071129 0%, #02121a 100%);
      color:#e6eef8;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
    }

    .wrap{
      width:100%;
      max-width:920px;
    }

    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:18px;
    }
    .logo{
      width:56px;height:56px;border-radius:10px;
      background:linear-gradient(135deg,var(--accent),var(--accent-600));
      display:flex;align-items:center;justify-content:center;font-weight:700;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5);
      font-family:monospace;
    }
    h1{font-size:20px;margin:0}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:14px}

    main{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:18px;
    }

    @media (max-width:780px){
      main{grid-template-columns: 1fr;}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      padding:18px;
      border-radius:12px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    }

    .label{font-size:13px;color:var(--muted);margin-bottom:8px}
    .controls{display:flex;gap:8px;align-items:center}
    input[type="text"]{
      flex:1;
      background:transparent;border:1px solid rgba(255,255,255,0.06);
      padding:10px 12px;border-radius:8px;color:inherit;font-size:16px;
      outline:none;transition:box-shadow .12s, border-color .12s;
    }
    input[type="text"]:focus{box-shadow:0 0 0 4px rgba(124,58,237,0.12);border-color:var(--accent)}
    button{
      background:linear-gradient(180deg,var(--accent),var(--accent-600));
      color:white;border:0;padding:10px 14px;border-radius:9px;font-weight:600;cursor:pointer;
      box-shadow:0 6px 16px rgba(109,40,217,0.18);
    }
    button.ghost{
      background:transparent;border:1px solid rgba(255,255,255,0.06);
      color:var(--muted);font-weight:600;
    }
    .result{
      margin-top:12px;padding:12px;border-radius:8px;background:var(--glass);
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .result .value{font-size:18px;font-weight:700}
    .muted{color:var(--muted);font-size:13px}

    .notice{margin-top:8px;font-size:13px;color:var(--muted)}
    .row-actions{display:flex;gap:8px;align-items:center}

    .badge{
      padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.04);font-weight:600;font-size:13px;
    }

    .ok{color:var(--success)}
    .err{color:var(--danger)}

    footer{margin-top:14px;color:var(--muted);font-size:13px;text-align:center}
    .copy{
      background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 8px;border-radius:8px;color:var(--muted);cursor:pointer;
    }

    small.hint{color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">RN</div>
      <div>
        <h1>Roman Converter</h1>
        <p class="lead">Convierte entre números romanos y arábigos. Rápido y simple.</p>
      </div>
    </header>

    <main>
      <section class="card" aria-labelledby="rom-to-arabic">
        <div id="rom-to-arabic" class="label">Romano → Árabe</div>
        <div class="controls">
          <input id="rom" type="text" inputmode="latin" placeholder="Ej: XXIV" aria-label="Número romano" />
          <button id="btnToArabic">Convertir</button>
          <button id="clearRom" class="ghost" title="Borrar">Borrar</button>
        </div>

        <div id="outCard1" class="result" aria-live="polite" role="status" hidden>
          <div>
            <div class="muted">Resultado</div>
            <div class="value" id="out1">—</div>
            <div class="notice" id="notice1"></div>
          </div>
          <div class="row-actions">
            <button class="copy" id="copy1" title="Copiar">Copiar</button>
          </div>
        </div>

        <p class="notice"><small class="hint">Formato canónico: IV, IX, XL, CM. Formas inválidas serán rechazadas.</small></p>
      </section>

      <section class="card" aria-labelledby="arabic-to-roman">
        <div id="arabic-to-roman" class="label">Árabe → Romano</div>
        <div class="controls">
          <input id="num" type="text" inputmode="numeric" placeholder="Ej: 24" aria-label="Número arábigo" />
          <button id="btnToRoman">Convertir</button>
          <button id="clearNum" class="ghost" title="Borrar">Borrar</button>
        </div>

        <div id="outCard2" class="result" aria-live="polite" role="status" hidden>
          <div>
            <div class="muted">Resultado</div>
            <div class="value" id="out2">—</div>
            <div class="notice" id="notice2"></div>
          </div>
          <div class="row-actions">
            <button class="copy" id="copy2" title="Copiar">Copiar</button>
          </div>
        </div>

        <p class="notice"><small class="hint">Acepta enteros entre 1 y 3999.</small></p>
      </section>
    </main>

    <footer>
      <span class="muted">Hecho con ❤️ — API: <code>/api/r2a?roman=</code> y <code>/api/a2r?number=</code></span>
    </footer>
  </div>

  <script>
    const base = '/api';

    async function fetchJson(url) {
      const res = await fetch(url);
      let json;
      try { json = await res.json(); } catch (e) { json = { error: 'invalid json' }; }
      return { ok: res.ok, status: res.status, json };
    }

    // helpers UI
    const showOut = (cardId, valueEl, noticeEl, copyBtn, data, ok=true) => {
      const card = document.getElementById(cardId);
      card.hidden = false;
      document.getElementById(valueEl).textContent = data;
      document.getElementById(noticeEl).textContent = ok ? '' : data;
      copyBtn.disabled = !ok;
    };

    // ROMANO -> ARÁBIGO
    document.getElementById('btnToArabic').addEventListener('click', async () => {
      const r = document.getElementById('rom').value.trim();
      if (!r) { alert('Ingresa un número romano'); return; }
      const url = `${base}/r2a?roman=${encodeURIComponent(r)}`;
      const { ok, status, json } = await fetchJson(url);
      if (!ok) {
        showOut('outCard1', 'out1', 'notice1', document.getElementById('copy1'), `Error ${status}: ${json.error || JSON.stringify(json)}`, false);
      } else {
        showOut('outCard1', 'out1', 'notice1', document.getElementById('copy1'), json.arabic, true);
      }
    });

    // ÁRABIGO -> ROMANO
    document.getElementById('btnToRoman').addEventListener('click', async () => {
      const n = document.getElementById('num').value.trim();
      if (!n) { alert('Ingresa un número'); return; }
      const url = `${base}/a2r?number=${encodeURIComponent(n)}`;
      const { ok, status, json } = await fetchJson(url);
      if (!ok) {
        showOut('outCard2', 'out2', 'notice2', document.getElementById('copy2'), `Error ${status}: ${json.error || JSON.stringify(json)}`, false);
      } else {
        showOut('outCard2', 'out2', 'notice2', document.getElementById('copy2'), json.roman, true);
      }
    });

    // copy buttons
    document.getElementById('copy1').addEventListener('click', async () => {
      const text = document.getElementById('out1').textContent;
      try { await navigator.clipboard.writeText(text); alert('Copiado: ' + text); } catch { alert('No se pudo copiar'); }
    });
    document.getElementById('copy2').addEventListener('click', async () => {
      const text = document.getElementById('out2').textContent;
      try { await navigator.clipboard.writeText(text); alert('Copiado: ' + text); } catch { alert('No se pudo copiar'); }
    });

    // clear buttons
    document.getElementById('clearRom').addEventListener('click', () => {
      document.getElementById('rom').value=''; document.getElementById('outCard1').hidden=true;
    });
    document.getElementById('clearNum').addEventListener('click', () => {
      document.getElementById('num').value=''; document.getElementById('outCard2').hidden=true;
    });

    // small UX: submit on enter
    document.getElementById('rom').addEventListener('keydown', (e) => { if (e.key === 'Enter') document.getElementById('btnToArabic').click(); });
    document.getElementById('num').addEventListener('keydown', (e) => { if (e.key === 'Enter') document.getElementById('btnToRoman').click(); });
  </script>
</body>
</html>
